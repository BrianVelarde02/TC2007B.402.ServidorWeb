{"filter":false,"title":"EncryptionService.cs","tooltip":"/Backend/Services/EncryptionService.cs","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":33,"column":0},"action":"insert","lines":["using Microsoft.AspNetCore.DataProtection;","","namespace Backend.Services","{","    public interface IEncryptionService","    {","        string Protect(string plain);","        string Unprotect(string cipher);","    }","","    public class EncryptionService : IEncryptionService","    {","        private readonly IDataProtector _protector;","","        public EncryptionService(IDataProtectionProvider provider)","        {","            _protector = provider.CreateProtector(\"UserData\");","        }","","        public string Protect(string plain)","        {","            if (string.IsNullOrEmpty(plain)) return plain;","            return _protector.Protect(plain);","        }","","        public string Unprotect(string cipher)","        {","            if (string.IsNullOrEmpty(cipher)) return cipher;","            try { return _protector.Unprotect(cipher); }","            catch { return cipher; } // si no est√° protegido, regresamos tal cual (compatibilidad)","        }","    }","}",""],"id":1}]]},"ace":{"folds":[],"scrolltop":20,"scrollleft":0,"selection":{"start":{"row":13,"column":0},"end":{"row":13,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1759434462724,"hash":"f63e1b4c7a471940e2089ffd1b650a0b8c19ce36"}