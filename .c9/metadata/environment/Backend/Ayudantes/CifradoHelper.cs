{"filter":false,"title":"CifradoHelper.cs","tooltip":"/Backend/Ayudantes/CifradoHelper.cs","undoManager":{"mark":2,"position":2,"stack":[[{"start":{"row":0,"column":0},"end":{"row":17,"column":0},"action":"insert","lines":["using System.Security.Cryptography;","using System.Text;","","namespace Backend.Ayudantes","{","    public static class HashAyudante","    {","        public static string HashCorreo(string correo)","        {","            if (string.IsNullOrWhiteSpace(correo)) return string.Empty;","            using var sha = SHA256.Create();","            var normalizado = correo.Trim().ToLowerInvariant();","            var bytes = Encoding.UTF8.GetBytes(normalizado);","            return Convert.ToBase64String(sha.ComputeHash(bytes));","        }","    }","}",""],"id":2}],[{"start":{"row":0,"column":0},"end":{"row":17,"column":0},"action":"remove","lines":["using System.Security.Cryptography;","using System.Text;","","namespace Backend.Ayudantes","{","    public static class HashAyudante","    {","        public static string HashCorreo(string correo)","        {","            if (string.IsNullOrWhiteSpace(correo)) return string.Empty;","            using var sha = SHA256.Create();","            var normalizado = correo.Trim().ToLowerInvariant();","            var bytes = Encoding.UTF8.GetBytes(normalizado);","            return Convert.ToBase64String(sha.ComputeHash(bytes));","        }","    }","}",""]},{"start":{"row":0,"column":0},"end":{"row":21,"column":0},"action":"insert","lines":["// Backend/Ayudantes/CifradoHelper.cs","using Microsoft.AspNetCore.DataProtection;","","namespace Backend.Ayudantes","{","    public static class CifradoHelper","    {","        public static string SafeUnprotect(IDataProtector protector, string encrypted)","        {","            if (string.IsNullOrEmpty(encrypted)) return encrypted;","            try","            {","                return protector.Unprotect(encrypted);","            }","            catch","            {","                return encrypted; // Si falla, devuelve lo encriptado","            }","        }","    }","}",""]}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["// Backend/Ayudantes/CifradoHelper.cs",""],"id":4}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":16,"column":13},"end":{"row":16,"column":13},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1759523174398,"hash":"33a89a0378a6b3a0be5af5c79a99a1a895402193"}